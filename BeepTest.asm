; BeepTest.asm
; Demonstrates 2031 Project peripheral base and added functionality
; Plays lowest & highest note within 1% error in 100 Hz - 5 kHz range
; Demonstrates added functionality by playing a song

ORG 0

; Demonstrate extreme notes in 100 Hz - 5 kHz range

; Play 103 Hz to left speaker for 10s
LOADI &b10
OUT    ChnSel
LOADI 1000
OUT duration
LOADI 71; 103/1.46 = 71
OUT    Beep
CALL    Delay

; Play 4978 Hz to both speakers for 10s
LOADI &b11
OUT    ChnSel
LOADI 1000; 4978/1.46 = 1000
OUT duration
LOAD High
OUT    Beep
CALL    Delay

; Demonstrate channel switching & duration control
: Play Old McDonald Had A Farm 

OLDMCD:
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  401
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  450
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  450
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  401
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  674
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  674
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  601
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  601
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
CALL    Delay
LOADI 20
OUT duration
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  401
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  401
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  450
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  450
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  401
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  674
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  674
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  601
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  601
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
CALL    Delay
LOADI 20
OUT duration
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  401
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  401
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  401
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  401
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
CALL    Delay
LOADI 01
OUT    ChnSel
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 10
OUT    ChnSel
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 01
OUT    ChnSel
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 10
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay

LOADI 10
OUT    ChnSel
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 20
OUT duration
LOADI  535
OUT    Beep
CALL    Delay
LOADI 1
OUT duration
LOADI 0
OUT    Beep
CALL    Delay
LOADI 11
OUT    ChnSel
JUMP OLDMCD


Delay:
	IN Duration
	JZERO delay
	RETURN

; IO address constants
OneSec:    EQU 010
OneTenth:  EQU 001
Left:	   DW  &B01
Beep:      EQU &H40
ChnSel:	   EQU &H41
Duration:  EQU &H42
High:      DW 3398 ; Highest note, uses DW to due to bit size constraints
